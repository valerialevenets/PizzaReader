services:
    backend:
        build:
            context: .
            dockerfile: Dockerfile
        volumes:
            - .:/var/www/pizzareader
    queue:
        build:
            context: .
            dockerfile: Dockerfile.queue
        volumes:
            - .:/var/www/pizzareader
        command: [ "php", "/var/www/pizzareader/artisan", "queue:work", "--tries=3" ]
        stop_signal: SIGTERM # Set this for graceful shutdown if you're using fpm-apache or fpm-nginx
        healthcheck:
            # This is our native healthcheck script for the queue
            test: [ "CMD", "healthcheck-queue" ]
            start_period: 10s
